<!-- Generated by SpecStory -->

# Missing ForgotPasswordParams Issue (2025-03-30 14:38:11)

_**User**_

Why ForgoPasswordParams cannot be found in this context?

---

_**Assistant**_

Let me help you investigate why `ForgotPasswordParams` cannot be found in this context. First, I'll look at the surrounding code to understand where this struct should be defined.

---

Read file: src/controllers/auth_pages.rs

---

Looking at the code, I can see that `ForgotPasswordParams` is being used but it's not defined in this file. Let me search for where it might be defined.

---

<details>
            <summary>Searched codebase "struct ForgotPasswordParams" â€¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/controllers/auth_api.rs` | L72-130 |
| `src/controllers/auth_pages.rs` | L188-248 |
| `src/models/users.rs` | L1-73 |
| `src/controllers/auth_api.rs` | L1-72 |
| `src/mailers/auth.rs` | L55-86 |
| `doc/dev/roadmap/phase-1/cursor-chat-history/2025-03-26_13-56-fixing-non-functional-front-end-features.md` | L413-504 |
| `tests/requests/auth.rs` | L175-239 |
| `src/models/users.rs` | L289-345 |
| `assets/views/auth/forgot-password.html` | L1-31 |
| `doc/dev/roadmap/phase-1/cursor-chat-history/2025-03-25_07-26-requirements-verification-and-implementation.md` | L11396-11450 |
| `src/models/users.rs` | L345-391 |
| `src/mailers/auth/forgot/html.t` | L1-12 |
| `src/mailers/auth/forgot/text.t` | L1-4 |
| `src/mailers/auth/forgot/subject.t` | L1-2 |
| `tests/models/users.rs` | L176-219 |
| `src/controllers/auth_pages.rs` | L296-326 |
| `src/mailers/auth.rs` | L1-55 |
| `tests/models/snapshots/can_create_with_password@users.snap` | L1-24 |
| `src/models/_entities/users.rs` | L1-39 |
| `src/controllers/users_pages.rs` | L119-186 |
| `doc/dev/roadmap/phase-1/cursor-chat-history/2025-03-25_07-26-requirements-verification-and-implementation.md` | L12890-12973 |
| `src/models/users.rs` | L234-289 |
| `tests/requests/snapshots/can_register@auth_request.snap` | L1-28 |
| `assets/views/auth/login.html` | L34-63 |
| `src/controllers/auth_pages.rs` | L31-67 |

</details>

---

I can see the issue now. The problem is that in `auth_pages.rs`, you're trying to use `ForgotPasswordParams` but you're using the wrong struct. There are two similar structs:

1. `ForgotPasswordParams` in `models/users.rs` which is used for API endpoints
2. `LoginParams` which you're currently trying to use in the form handler

To fix this, you need to either:

1. Use the existing `ForgotPasswordParams` from the models module, or
2. Create a new form-specific struct for handling the forgot password form data

Let's use the existing `ForgotPasswordParams` from the models module. Here's how to fix it:

```rust:src/controllers/auth_pages.rs
// ... existing code ...

#[debug_handler]
async fn handle_forgot_password(
    ViewEngine(v): ViewEngine<TeraView>,
    State(_ctx): State<AppContext>,
    Form(form): Form<ForgotPasswordParams>, // Change from LoginParams to ForgotPasswordParams
) -> Result<Response> {
    let params = ForgotPasswordParams {
        email: form.email.clone(),
    };
    // TODO: Send email with reset link
    format::render().view(
        &v,
        "auth/reset-sent.html",
        data!({}),
    )
}

// ... existing code ...
```

You'll need to add this import at the top of the file:

```rust
use crate::models::users::ForgotPasswordParams;
```

This change aligns with both:
1. The form data being submitted from `forgot-password.html` which only contains an email field
2. The existing `ForgotPasswordParams` struct in the models which matches this structure

The error occurred because you were trying to use `LoginParams` which has both email and password fields, but the forgot password form only submits an email field. Using the correct `ForgotPasswordParams` struct will resolve the compilation error.

---



---

