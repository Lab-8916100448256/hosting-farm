<!-- Generated by SpecStory -->

# Email Change Confirmation Dialog (2025-04-19 14:45:22)

_**User**_

On the profile page, when the user is modifying its email address and click on the save button, a confirmation dialog should be displayed before sending the request to the server

---

_**Assistant**_



---

Okay, I understand. To implement this, I need to modify the profile page template (`assets/views/users/profile.html`) to include some client-side logic (likely using Hyperscript, following the project guidelines) that intercepts the form submission.

First, I'll read the content of the template file to understand its structure.

---

Read file: assets/views/users/profile.html

---

Okay, I have the template code. I'll add a Hyperscript `_` attribute to the profile update form.

This script will:
1. Initialize a variable `initialEmail` with the current user's email on load.
2. On the `htmx:configRequest` event (which fires just before an HTMX request is made):
    - Get the current value from the email input field.
    - Compare it with `initialEmail`.
    - If they are different, show a `confirm()` dialog.
    - If the user cancels the dialog, prevent the HTMX request using `event.preventDefault()`.

I'll now apply this change to `assets/views/users/profile.html`.

---

```diff
              </div>
              <div class="mt-5 md:mt-0 md:col-span-2">
-                 <form action="/users/profile" hx-post="/users/profile" hx-target="#error-container" hx-swap="innerHTML" class="space-y-4">
+                 <form 
+                     action="/users/profile" 
+                     hx-post="/users/profile" 
+                     hx-target="#error-container" 
+                     hx-swap="innerHTML" 
+                     class="space-y-4"
+                     _="on load set initialEmail to #email.value
+                        on htmx:configRequest(event) from me
+                            if #email.value is not initialEmail
+                                if not confirm('You have changed your email address. Are you sure you want to proceed?')
+                                    halt the event
+                                end
+                            end
+                        end"
+                 >
                      <div class="grid grid-cols-6 gap-6">
                          <div class="col-span-6 sm:col-span-4">
```

---

I've added the Hyperscript logic to the profile update form in `assets/views/users/profile.html`. Now, when the user changes their email address and clicks "Save Profile", a confirmation dialog will appear before the request is sent to the server.

---



---

